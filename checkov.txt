

       _               _              
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V / 
  \___|_| |_|\___|\___|_|\_\___/ \_/  
                                      
By bridgecrew.io | version: 2.5.19 
Update available 2.5.19 -> 3.0.0
Run pip3 install -U checkov to update 


terraform scan results:

Passed checks: 2, Failed checks: 1, Skipped checks: 0

Check: CKV_TF_1: "Ensure Terraform module sources use a commit hash"
	PASSED for resource: test-vm
	File: /main.tf:40-56
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/supply-chain-policies/terraform-policies/ensure-terraform-module-sources-use-git-url-with-commit-hash-revision.html
Check: CKV_YC_12: "Ensure public IP is not assigned to database cluster."
	PASSED for resource: module.mysql.yandex_mdb_mysql_cluster.mysql
	File: /mysql/main.tf:1-22
	Calling File: /main.tf:21-38
Check: CKV_YC_1: "Ensure security group is assigned to database cluster."
	FAILED for resource: module.mysql.yandex_mdb_mysql_cluster.mysql
	File: /mysql/main.tf:1-22
	Calling File: /main.tf:21-38

		1  | resource "yandex_mdb_mysql_cluster" "mysql" {
		2  |   name                = var.cluster_name
		3  |   environment         = var.env
		4  |   network_id          = var.network_id
		5  |   version             = var.version_mysql
		6  |   deletion_protection = false
		7  | 
		8  |   resources {
		9  |     resource_preset_id = var.preset_id
		10 |     disk_type_id       = var.disk_type
		11 |     disk_size          = var.disk_size
		12 |   }
		13 | 
		14 |   dynamic "host" {
		15 |     for_each          = var.hosts_mysql 
		16 |     content {
		17 |     zone              = lookup(host.value, "zone", null)
		18 |     subnet_id         = lookup(host.value, "subnet_id", null)
		19 |     }
		20 |    }
		21 | 
		22 | }


